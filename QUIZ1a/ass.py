#author Mohammed Khandwawala
#date 26/04/18

from pylab import *
import numpy as np
import matplotlib.pyplot as plt

pos = np.zeros(1100)
vel = np.zeros(1100)
dx = np.zeros(1100)
count = 0
density = 0
D = []
T = []
t = 10**-6

pos[0] = 0.001
vel[0] = 1000

for i in range(15000):
    jj = np.where(pos > 0)[0]
    vel[jj] = vel[jj] + 2e5*sin(1000*np.pi*t)*1e-6
    dx[jj] = vel[jj]*1e-6 + 0.5*(2e5*sin(1000*np.pi*t))*1e-12
    pos[jj] = pos[jj] + dx[jj]
    kk = np.where(pos >= 1)[0]
    pos[kk] = 0
    vel[kk] = 0
    density+=len(kk)
    if(count%50 == 0):
        D.append(density)  
        density = 0
        T.append(t)
    count +=1
    t += 1e-6
    ii = np.where(pos == 0)[0]
    vel[ii[0]] = 1000
    dx[ii[0]] =  vel[ii[0]]*1e-6 + 1e5*sin(1000*np.pi*t)*1e-12
    pos[ii[0]] = 1000*1e-6 + dx[ii[0]]
plt.plot(D)
plt.show()
#D = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 55, 54, 51, 50, 49, 47, 46, 45, 44, 43, 42, 41, 41, 40, 40, 40, 39, 40, 40, 41, 42, 42, 44, 46, 47, 49, 52, 54, 57, 60, 61, 63, 65, 64, 65, 63, 62, 60, 59, 57, 55, 54, 51, 50, 49, 47, 46, 45, 44, 43, 42, 41, 41, 40, 40, 40, 39, 40, 40, 41, 42, 42, 44, 46, 47, 49, 52, 54, 57, 60, 61, 63, 65, 64, 65, 63, 62, 60, 59, 57, 55, 54, 51, 50, 49, 47, 46, 45, 44, 43, 42, 41, 41, 40, 40, 40, 39, 40, 40, 41, 42, 42, 44, 46, 47, 49, 52, 54, 57, 60, 61, 63, 65, 64, 65, 63, 62, 60, 59, 57, 55, 54, 51, 50, 49, 47, 46, 45, 44, 43, 42, 41, 41, 40, 40, 40, 39, 40, 40, 41, 42, 42, 44, 46, 47, 49, 52, 54, 57, 60, 61, 63, 65, 64, 65, 63, 62, 60, 59, 57, 55, 54, 51, 50, 49, 47, 46, 45, 44, 43, 42, 41, 41, 40, 40, 40, 39, 40, 40, 41, 42, 42, 44, 46, 47, 49, 52, 54, 57, 60, 61, 63, 65, 64, 65, 63, 62, 60, 59, 57, 55, 54, 51, 50, 49, 47, 46, 45, 44, 43, 42, 41, 41, 40, 40, 40, 39, 40, 40, 41, 42, 42, 44, 46, 47, 49, 52, 54, 57, 60, 61, 63, 65, 64, 65, 63, 62, 60, 59, 57, 55, 54, 51, 50, 49, 47, 46, 45, 44, 43, 42, 41, 41, 40, 40, 40, 39, 40, 40, 41, 42, 42, 44, 46, 47, 49, 52, 54, 57, 60, 61, 63, 65, 64, 65, 63, 62, 60, 59, 57]
D = D[44:]
d_fft = fft(D)
n = arange(256)
wnd = 0.54 + 0.46*np.cos(2*np.pi*n/256.0)
wnd = fftshift(wnd)
plt.plot(wnd)
plt.show()
D = D*wnd
D[0] = 0
plt.plot(D)
plt.show()
A = fftshift(fft(D))/256.0
plt.plot(fftshift(fft(D))/256.0)
plt.show()
plt.plot(ifft(ifftshift(A)))
plt.show()



		

